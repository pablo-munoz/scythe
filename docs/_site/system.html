<html>
  <head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css"/>
    <link rel="stylesheet" href="public/solarized-dark.css"/>
    <link rel="stylesheet" href="public/style.css"/>
  </head>
  <body>
    <header class="navbar navbar-static-top docs-nav" id="top" role="banner">
      <div class="container">
        <div class="navbar-header">
          <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#docs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a href="index.html" class="navbar-brand">Scythe</a>
        </div>
        <nav id="docs-navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a href="intro.html">Introduction</a></li>
            <li><a href="users.html">User's Guide</a></li>
            <li><a href="system.html">System Documentation</a></li>
            <li><a href="acknowledgements.html">Acknowledgements</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <div class="docs-header" tabindex="-1">
      <div class="container">
        <h1>System Documentation</h1>
        <p></p>
      </div>
    </div>

    <script src="public/jquery.min.js"></script>
    <script src="public/toc.js"></script>
    <div class="container">
      <div class="row">
        <div id="content" class="col-md-9">
          

<div>
  <h1>Dependencies</h1>

  <p>Scythe depends on the following packages, they all were installed
  through the node package manager.</p><pre class="hljs"><code><span class="hljs-keyword">var</span> fse       = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs-extra'</span>);
<span class="hljs-keyword">var</span> path      = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">var</span> nunjucks  = <span class="hljs-built_in">require</span>(<span class="hljs-string">'nunjucks'</span>);
<span class="hljs-keyword">var</span> highlight = <span class="hljs-built_in">require</span>(<span class="hljs-string">'highlight.js'</span>);
<span class="hljs-keyword">var</span> yaml      = <span class="hljs-built_in">require</span>(<span class="hljs-string">'js-yaml'</span>);
<span class="hljs-keyword">var</span> _         = <span class="hljs-built_in">require</span>(<span class="hljs-string">'lodash'</span>);
<span class="hljs-keyword">var</span> q         = <span class="hljs-built_in">require</span>(<span class="hljs-string">'q'</span>);
<span class="hljs-keyword">var</span> program   = <span class="hljs-built_in">require</span>(<span class="hljs-string">'commander'</span>);
<span class="hljs-keyword">var</span> promptly  = <span class="hljs-built_in">require</span>(<span class="hljs-string">'promptly'</span>);</pre></code></ref>

  <p>The following is a brief description of each module in conjuction
  with some insights to what their role is within the system.</p>

  <table class="table">
    <thead>
      <tr>
        <th>Module</th>
        <th>Desription</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="mono">fs&#8209;extra</td>
        <td>An extended version of Node's standard <code>fs</code> module. It
          includes extra functionality such as the ability to copy files or
          walk a directory.</td>
      </tr>
      <tr>
        <td class="mono">path</td>
        <td>Node's standard path module. It provides the facilities for
          manipulating filesystem paths and doing things with them such
          as determining their extension or coming up with relative paths
          from one file to another.</td>
      </tr>
      <tr>
        <td class="mono">nunjucks</td>
        <td>The template engine used to process the html files that will be
          the pages of the generated static site. As a referesher, a templating
          engine is a program that process some html file or string that
          can contain some non-standard syntax which gets expanded into
          html in the output.</td>
      </tr>
      <tr>
        <td class="mono">highlight.js</td>
        <td>The server side version of highlightjs, a JavaScript program that,
          when given a string of source code it returns a version of it that has
          been marked up with html and that with, in conjuction with a css file
          result in the given code to appear syntax highlighted in the browser,
          much like it would do in any fancy text editor.</td>
      </tr>
      <tr>
        <td class="mono">js-yaml</td>
        <td>A processor of yaml (yaml is a file format used to
          describe data, much like JSON), it is used in several parts
          of the application where the system reads yaml file written
          by the user with custom data.</td>
      </tr>
      <tr>
        <td class="mono">underscore</td>
        <td>A collection of utility functions which make writing
          JavaScript code simpler and allow for the use of a more
          functional-oriented programming style.</td>
      </tr>
      <tr>
        <td class="mono">q</td>
        <td>A library for implementeing the promise interface in our code. For
          the unexperienced, the promise interface is a way to orchestrate
          the run order of a several asynchronous functions.</td>
      </tr>
      <tr>
        <td class="mono">commander</td>
        <td>This node modules facilitiates the creation of command line
        interfaces.</td>
      </tr>
      <tr>
        <td class="mono">promptly</td>
        <td>In some parts of the application we need to stop and ask
          the user for confirmation or to give us some additional
          data, this library implements methods for establishing
          communication with the user.</td>
      </tr>
    </tbody>
  </table>

  <div class="alert alert-warning">Notice how the name of the required
    modules does not necessary match the name of the variable used to
    referenc them. For example, the module <code>fs-extra</code> is
    referred to by the variable <code>fse</code>.</div>
</div>

<div>
  <h1>Manifest constants</h1>

  <h2><span class="mono">CONFIG_FILENAME</span></h2><pre class="hljs"><code><span class="hljs-keyword">var</span> CONFIG_FILENAME = <span class="hljs-string">'_config.yml'</span>;</pre></code></ref>

  <p>This is the name that the configuration file should have, if
  there is one, within the current workig directory.</p>


  <h2><span class="mono">MODULE_ROOT</span></h2><pre class="hljs"><code><span class="hljs-keyword">var</span> MODULE_ROOT = path.dirname(__filename);</pre></code></ref>

  <p>This is the absolute path of the directory where the scythe module
  was installed within the user's system.</p>


  <h2><span class="mono">FILE_TYPE_...</span></h2><pre class="hljs"><code><span class="hljs-keyword">var</span> FILE_TYPE_SPECIAL = <span class="hljs-string">'SPECIAL'</span>;
<span class="hljs-keyword">var</span> FILE_TYPE_PAGE = <span class="hljs-string">'PAGE'</span>;
<span class="hljs-keyword">var</span> FILE_TYPE_VERBATIM = <span class="hljs-string">'VERBATIM'</span>;</pre></code></ref>

  <p>These constants are used to identify each of the 3 possible types
  that a file within the input dir can have.</p>


  <h2><span class="mono">CODE_REF_IN_HTML_REGEX</span></h2><pre class="hljs"><code><span class="hljs-keyword">var</span> CODE_REF_IN_HTML_REGEX = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>([
    <span class="hljs-string">'\\s*'</span>,                         <span class="hljs-comment">// Zero or more spaces</span>
    <span class="hljs-string">'&lt;ref\\s+'</span>,                     <span class="hljs-comment">// "ref" tag opening</span>
    <span class="hljs-string">'name="(.+)"'</span>,                  <span class="hljs-comment">// The name of the reference (capture)</span>
    <span class="hljs-string">'\\s*'</span>,                         <span class="hljs-comment">// Zero or more spaces</span>
    <span class="hljs-string">'file="(.+)"'</span>,                  <span class="hljs-comment">// File where the reference is (capture)</span>
    <span class="hljs-string">'\\s*'</span>,                         <span class="hljs-comment">// Zero or more spaces</span>
    <span class="hljs-string">'&gt;'</span>                             <span class="hljs-comment">// Tag close</span>
].join(<span class="hljs-string">''</span>), <span class="hljs-string">'g'</span>);</pre></code></ref>

  <p>This is a regular expression that matches the reference to code
    that the user puts in the html files that will be the pages of the
    generated website.</p>

  <h2><span class="mono">BLOCK_CODE_REF_IN_SRC_REGEX</span></h2><pre class="hljs"><code><span class="hljs-keyword">var</span> BLOCK_CODE_REF_IN_SRC_REGEX = _.mapValues(
    fse.readJsonSync(path.join(MODULE_ROOT, <span class="hljs-string">'languages.json'</span>)), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">obj</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>([
            <span class="hljs-string">'[^\\S\\n]*'</span>,
            obj.symbol,                       <span class="hljs-comment">// Comment syntax</span>
            <span class="hljs-string">'[^\\S\\n]*'</span>,
            <span class="hljs-string">'\\+{3}'</span>,                         <span class="hljs-comment">// Three consecutive plus symbols</span>
            <span class="hljs-string">'[^\\S\\n]*'</span>,
            <span class="hljs-string">'(.+)'</span>,                           <span class="hljs-comment">// The name of the reference (capture)</span>
            <span class="hljs-string">'\\n'</span>,                            <span class="hljs-comment">// Newline</span>
            <span class="hljs-string">'([\\s\\S]+)\\n'</span>,                 <span class="hljs-comment">// The actual code (capture),</span>
            <span class="hljs-string">'[^\\S\\n]*'</span>,
            obj.symbol,                       <span class="hljs-comment">// Comment syntax</span>
            <span class="hljs-string">'[^\\S\\n]*'</span>,
            <span class="hljs-string">'\\-{3}'</span>,                         <span class="hljs-comment">// Three consecutive minus symbols</span>
            <span class="hljs-string">'[^\\S\\n]*'</span>,
            <span class="hljs-string">'\\1'</span>,                            <span class="hljs-comment">// Same name reference of the comment start</span>
        ].join(<span class="hljs-string">''</span>), <span class="hljs-string">'g'</span>)
    });</pre></code></ref>

  <p>This is a JavaScript plain object used as a dictionary that
    maps file extensions, e.g. ".js", to the regular expressions that match
    code references of type "block".</p>


  <h2><span class="mono">SIMPLE_CODE_REF_IN_SRC_REGEX</span></h2><pre class="hljs"><code><span class="hljs-keyword">var</span> SIMPLE_CODE_REF_IN_SRC_REGEX = _.mapValues(
    fse.readJsonSync(path.join(MODULE_ROOT, <span class="hljs-string">'languages.json'</span>)), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">obj</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>([
            <span class="hljs-string">'[^\\S\\n]*'</span>,
            obj.symbol,                       <span class="hljs-comment">// Comment syntax</span>
            <span class="hljs-string">'[^\\S\\n]*'</span>,
            <span class="hljs-string">'\\+\\-'</span>,                         <span class="hljs-comment">// Three consecutive plus symbols</span>
            <span class="hljs-string">'[^\\S\\n]*'</span>,
            <span class="hljs-string">'(.+)'</span>,                           <span class="hljs-comment">// The name of the reference (capture)</span>
            <span class="hljs-string">'\\n'</span>,                            <span class="hljs-comment">// Newline</span>
            <span class="hljs-string">'([\\s\\S]+?)\\n\\n'</span>,                 <span class="hljs-comment">// The actual code (capture),</span>
        ].join(<span class="hljs-string">''</span>), <span class="hljs-string">'g'</span>)
    });</pre></code></ref>

  <p>This is a JavaScript plain object used as a dictionary that
    maps file extensions, e.g. ".js", to the regular expressions that match
    code references of type "simple".</p>
</div>

<div>
  <h1>CLI program</h1>

  <h2>Configuration</h2><pre class="hljs"><code>program
    .version(<span class="hljs-string">'0.1.0'</span>);</pre></code></ref>

  <h2><span class="mono">mksite</span> command</h2><pre class="hljs"><code>program
    .command(<span class="hljs-string">'mksite'</span>)
    .description(<span class="hljs-string">'Makes a static site out of the files in the cwd.'</span>)
    .action(main);</pre></code></ref>

  <h2><span class="mono">mktemplate</span> command</h2><pre class="hljs"><code>program
    .command(<span class="hljs-string">'mktemplate'</span>)
    .description(<span class="hljs-string">'Creates a "docs" directory with boilerplate.'</span>)
    .action(copyBootstrapTemplate)</pre></code></ref>
</div>


        </div>
        <div id="toc" class="col-md-3">
        </div>
      </div>
    </div>

    <script>
     $('#toc').toc({
       'selectors': 'h1,h2,h3',
       'container': '#content',
       'smoothScrolling': true,
       'prefix': 'toc',
       'highlightOffset': 100,
       'anchorName': function(i, heading, prefix) {
         return prefix+i;
       },
       'headerText': function(i, heading, $heading) {
         return $heading.html();
       }
     });
    </script>
  </body>
</html>
